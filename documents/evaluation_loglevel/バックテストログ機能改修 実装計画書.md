はい、承知いたしました。
これまでの設計内容に基づき、具体的な作業手順とスケジュールを定めた「実装計画書」を作成します。

-----

# バックテストログ機能改修 実装計画書

## 1\. 目的 🎯

本計画は、「バックテストログ機能改修 詳細設計書」に基づき、実装からテスト、リリースまでの一連の作業を円滑に進めることを目的とする。本改修により、大規模評価（`evaluation`）実行時のパフォーマンスを大幅に向上させる。

-----

## 2\. 実装スコープ SCOPE

本計画のスコープは、詳細設計書に記載された以下の5ファイルに対する改修作業に限定する。

  - **変更対象ファイル**:
      - `src/core/util/logger.py`
      - `src/backtest/config_backtest.py`
      - `src/evaluation/run_evaluation.py`
      - `src/evaluation/orchestrator.py`
  - **新規作成ファイル**:
      - `src/evaluation/config_evaluation.py`

**スコープ外**: 上記以外のファイルへの変更、および既存の取引ロジックの変更は本計画に含めない。

-----

## 3\. タスク一覧 (WBS) 📋

本改修は、以下のタスクに分解して実施する。

| ID | タスク名 | 担当者 | 見積工数 | 依存タスク |
| :--- | :--- | :--- | :--- | :--- |
| **1.0** | **コア機能の実装** | 開発担当 | **0.5 日** | - |
| 1.1 | `core.util.logger`の改修 (ログ無効化対応) | 開発担当 | 0.1 日 | - |
| 1.2 | `backtest.config`の修正 (デフォルトログレベル変更) | 開発担当 | 0.1 日 | - |
| 1.3 | `evaluation.config`の新規作成 | 開発担当 | 0.1 日 | - |
| 1.4 | `evaluation.run_evaluation`の改修 (ロガー初期化) | 開発担当 | 0.1 日 | - |
| 1.5 | `evaluation.orchestrator`の改修 (ファイル書き換え) | 開発担当 | 0.1 日 | 1.1, 1.3 |
| **2.0** | **テスト・動作確認** | 開発担当 | **1.0 日** | 1.0 |
| 2.1 | **正常系テスト**: `evaluation`実行時のログ無効化確認 | 開発担当 | 0.3 日 | 1.0 |
| 2.2 | **正常系テスト**: `backtest`単体実行時のログ出力確認 | 開発担当 | 0.2 日 | 1.0 |
| 2.3 | **機能テスト**: `evaluation`でのデバッグログ出力モード確認 | 開発担当 | 0.3 日 | 1.0 |
| 2.4 | **堅牢性テスト**: 設定ファイルの復元機能確認 | 開発担当 | 0.2 日 | 1.5 |
| **3.0** | **リリース準備** | 開発担当 | **0.5 日** | 2.0 |
| 3.1 | コードレビューおよびリファクタリング | 開発担当 | 0.3 日 | 2.0 |
| 3.2 | Gitリポジトリへのコミット | 開発担当 | 0.2 日 | 3.1 |
| **合計** | | | **2.0 日** | |

-----

## 4\. スケジュール 🗓️

本計画は以下のスケジュールで実施する。

| タスクID | タスク内容 | 2025/10/13 (月) | 2025/10/14 (火) | 2025/10/15 (水) |
| :--- | :--- | :---: | :---: | :---: |
| **1.0** | **コア機能の実装** | ■■■■■ | | |
| **2.0** | **テスト・動作確認** | | ■■■■■■■■■■ | |
| **3.0** | **リリース準備** | | | ■■■■■ |

  - **Day 1 (10/13)**: 詳細設計書に基づき、全てのコーディング作業を完了させる。
  - **Day 2 (10/14)**: テスト計画に基づき、全パターンの動作確認を入念に行う。
  - **Day 3 (10/15)**: 最終的なコードレビューを行い、問題がなければバージョン管理システムにコミットして改修を完了とする。

-----

## 5\. テスト計画 ✅

以下の項目についてテストを実施し、全ての項目で期待通りの動作をすることを確認する。

| テスト項目 | 操作手順 | 期待される結果 |
| :--- | :--- | :--- |
| **`evaluation` ログ無効化** | `config_evaluation.py` がデフォルトの状態で `python -m src.evaluation.run_evaluation` を実行する。 | `backtest_*.log` ファイルが生成されず、`evaluation` が高速に完了する。 |
| **`backtest` 単体実行** | `python -m src.backtest.run_backtest` を実行する。 | `backtest_*.log` が生成され、`INFO`レベルのログが出力されている。 |
| **`evaluation` デバッグモード** | `config_evaluation.py` の `BACKTEST_LOG_LEVEL_OVERRIDE` を `'DEBUG'` に変更して `evaluation` を実行する。 | 各戦略に対応する `backtest_*.log` が生成され、詳細なデバッグ情報が出力されている。 |
| **ファイル復元の確認** | `evaluation` 実行後、`src/backtest/config_backtest.py` を開く。 | `LOG_LEVEL = logging.INFO` の記述に戻っていることを確認する。 |

-----

## 6\. リスク管理 ⚠️

本改修において想定されるリスクと、その対策を以下に示す。

| リスク分類 | 内容 | 発生可能性 | 影響度 | 対応策 |
| :--- | :--- | :--- | :--- | :--- |
| **技術的リスク** | ファイルの復元処理に失敗し、`config_backtest.py`が破損する。 | 低 | 大 | ・`try...finally`構文による確実な復元処理を実装する。<br>・実装前にGitでブランチを作成し、いつでも元に戻せる状態を確保する。 |
| **性能リスク** | ログを抑制しても、`evaluation`の実行速度が期待通りに向上しない。 | 低 | 中 | ・別のボトルネック（CPU/メモリ/データアクセス等）が存在する可能性を考慮し、追加調査を行う。<br>・本改修はI/Oボトルネック解消を目的としており、一定の改善は見込めるため許容範囲とする。 |